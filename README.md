# **RT-qPCR Data Analysis**

This repository contains the complete R-based analytical workflow for processing and visualizing RT-qPCR data evaluating the impact of Plant Growth-Promoting Rhizobacteria (PGPR) on the accumulation of Potato Virus Y (PVY) in *Nicotiana benthamiana*. The study was conducted across three independent biological replicates, ensuring statistical robustness and reproducibility.

All scripts, visualizations, and statistical analyses are provided to support transparency and facilitate reproducibility. The full dataset used in this project is included in the repository under the folder named `Data/`.

**Note:** PGPR treatments were applied one week prior to PVY inoculation, allowing time for induced resistance responses to develop.

### Folder and File Structure
- [Data](https://github.com/BibechanaPaudel/Reproducibility-project/tree/main/Data): Contains .csv files for each of the three biological replicates.

- [Nb_PGPR+PVY.Rmd](https://github.com/BibechanaPaudel/Reproducibility-project/blob/main/Nb_PGPR%2BPVY.Rmd): The complete R script with code, output, and narrative.

- [Nb_PGPR+PVY.html](https://github.com/BibechanaPaudel/Reproducibility-project/blob/main/Nb_PGPR%2BPVY.html): Rendered HTML version of the RMarkdown.

- [Nb_PGPR+PVY.md](https://github.com/BibechanaPaudel/Reproducibility-project/blob/main/Nb_PGPR%2BPVY.md): Markdown-exported version for GitHub-friendly viewing.

- [Nb_PGPR+PVY_files/figure-gfm](https://github.com/BibechanaPaudel/Reproducibility-project/tree/main/Nb_PGPR%2BPVY_files/figure-gfm): Output plots in high-quality vector format (.png). 


### Project Overview

**Objective:**  
To evaluate whether PGPR treatments mitigate PVY accumulation, based on qPCR-derived Cq values, analyzed over time (Dpi) in both inoculated and systemic leaf tissues of *N. benthamiana*.

**Treatments:**
- Control  
- *Pseudomonas fluorescens*  
- *Serratia marcescens*  
- *Bacillus amyloliquefaciens*  
- *Bacillus subtilis*

### Script workflow

#### **1. Data Import and Preparation**

- Three biological replicate datasets (`.csv`) are stored in the `Data/` folder.
- All data are processed in a single RMarkdown (`.Rmd`) script.
- Each file contains Cq values from RT-qPCR for PVY quantification, along with metadata (Treatment, Dpi, Technical Replicate).
- Viral load is calculated from Cq values using the regression equation **Y= −3.93X+49.153**, where Y= Cq value and X= copy number of virus from [Feng, J.L et al., 2006](https://academic.oup.com/abbs/article/38/10/669/217), then log-transformed for normality.

#### **2. Data Grouping and Statistical Analysis**

- Data are grouped by Treatment, Days post-inoculation (Dpi), and Replicate.
- A linear model is fit to the log-transformed viral load to analyze interaction effects.
- Estimated marginal means are calculated using `emmeans`, followed by Tukey-adjusted pairwise comparisons.
- Significance groupings (letters) are extracted for visualisation.

#### **3. Visualisation**

- Bar plots are generated for:
  - **Inoculated leaves** at 1, 4, 7, and 10 Dpi
  - **Systemic leaves** at 7 and 10 Dpi
- Visuals include:
  - Grouped bar charts with error bars (standard error)
  - Statistical significance labels over bars
  - Combined plots with shared legends
- Color-blind friendly palettes are used.

#### **4. Statistical Testing**

- ANOVA and type-II tests (via `car::Anova`) assess Treatment*Dpi interactions.
- Post hoc multiple comparisons are performed using `emmeans` and `multcompView`.

### Citation
If you use this code for your research, please cite it using the Zenodo DOI provided here:

[![DOI](https://zenodo.org/badge/966418246.svg)](https://doi.org/10.5281/zenodo.15258548)

### Disclaimer
The code provided herein has not been peer-reviewed and may contain errors. Users are encouraged to test the code thoroughly and verify its accuracy for their specific applications. The author is not responsible for any errors or inaccuracies in the results generated by this script.

### File Tree

```
├── Data
│   ├── Nb_PGPR+PVY_1st_Reproducibility.csv   ## Data from first biological replication
│   ├── Nb_PGPR+PVY_2nd_Reproducibility.csv   ## Data from second biological replication
│   └── Nb_PGPR+PVY_3rd_Reproducibility.csv   ## Data from third biological replication
├── Nb_PGPR+PVY.html   ##script in html format
├── Nb_PGPR+PVY.md     ##script in github favoured markdowm format
├── Nb_PGPR+PVY.Rmd    ##script in rmd format
├── Nb_PGPR+PVY_files
│   └── figure-gfm
│       ├── Combine fig 1st trial-1.png  ## combine fig from 1st biological replication
│       ├── Combine fig 2nd trial-1.png  ## combine fig from 2nd biological replication
│       ├── Combine fig 3rd trial-1.png  ## combine fig from 3rd biological replication
│       ├── PVY on IL_1st trial_NB-1.png 
│       ├── PVY on IL_2nd trial_NB-1.png
│       ├── PVY on IL_3rd trial_NB-1.png
│       ├── PVY on SL_1st trial_NB-1.png
│       ├── PVY on SL_2ndtrial_NB-1.png
│       └── PVY on SL_3rdtrial_NB-1.png
├── README.md 
└── Reproducibility-project.Rproj
```